{% extends "base.html" %}
{% block content %}
    <h1>User Dashboard</h1>
    <h2 class="mt-4">Questions</h2>

    <ul class="list-group">
        {% if questions %}
            {% for question in questions %}
                <li class="list-group-item">
                    <h4>{{ question.question }}</h4>
                    {% if question.file %}
                        <p><strong>Attached File:</strong> <a href="{{ url_for('static', filename='uploads/' + question.file) }}" target="_blank">{{ question.file }}</a></p>
                    {% endif %}

                    <!-- Display previous replies for the question -->
                    <h5>Replies:</h5>
                        <ul class="list-group mb-4">
                            {% if question.replies and question.replies|length > 0 %}
                                {% for reply in question.replies %}
                                    <li class="list-group-item">
                                        <p>{{ reply.reply }}</p>
                                        {% if reply.file %}
                                            <p><strong>Attached File:</strong> <a href="{{ url_for('static', filename='uploads/' + reply.file) }}" target="_blank">{{ reply.file }}</a></p>
                                        {% endif %}
                                    </li>
                                {% endfor %}
                            {% else %}
                                <li class="list-group-item">No replies yet.</li>
                            {% endif %}
                        </ul>

                    <!-- Reply Form -->
                    <h5>Add Your Reply:</h5>
                    <form method="POST" action="{{ url_for('add_reply', question_id=question.id) }}" enctype="multipart/form-data">
                        <div class="form-group">
                            <textarea class="form-control" name="reply" rows="3" placeholder="Your reply" required></textarea>
                        </div>
                        <div class="form-group">
                            <label for="file">Attach a File (Optional)</label>
                            <input type="file" class="form-control" name="file">
                        </div>
                        <button type="submit" class="btn btn-primary">Submit Reply</button>
                    </form>
                </li>
            {% endfor %}
        {% else %}
            <li class="list-group-item">No questions available.</li>
        {% endif %}
    </ul>

{% endblock %}
